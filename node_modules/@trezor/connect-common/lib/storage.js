"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.load = exports.save = void 0;
var storageVersion = 1;
var storageName = "storage_v".concat(storageVersion);
var memoryStorage = {};
var getPermanentStorage = function () {
    var ls = localStorage.getItem(storageName);
    return ls ? JSON.parse(ls) : {};
};
var save = function (getNewState, temporary) {
    if (temporary === void 0) { temporary = false; }
    if (temporary || !global.window) {
        memoryStorage = getNewState(memoryStorage);
        return;
    }
    var newState = getNewState(getPermanentStorage());
    localStorage.setItem(storageName, JSON.stringify(newState));
};
exports.save = save;
var load = function (temporary) {
    var _a;
    if (temporary === void 0) { temporary = false; }
    if (temporary || !((_a = global === null || global === void 0 ? void 0 : global.window) === null || _a === void 0 ? void 0 : _a.localStorage)) {
        return memoryStorage;
    }
    return getPermanentStorage();
};
exports.load = load;
//# sourceMappingURL=storage.js.map